---
title: "Data Visualisation"
output: learnr::tutorial
runtime: shiny_prerendered
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  message = FALSE,
  warning = FALSE)
```


```{r}
library(tidyverse)
library(learnr)
library(ggplot2)
library(readr)
```

## A simple example of manipulating visualisation 
It is an interesting dataset with different kinds of chocolates in rows and many ingredients in columns.
* Different chocolates in rows can be defined as observations and ingredients are our variables.
* Our variables include fiber, fat, calories countries and etc...
* Use glimpse function to have a look at our data type relative to different variables  
```{r}
chocolates <- read_csv("data/chocolates.csv")
head(chocolates)
glimpse(chocolates) 
```

### Transform `Type` into factor  
* Use the `mutate` function in the `tidyverse` package 
* Pipe`%>%`Operator -- This operator will forward a value, or the result of an expression, into the next function call/expression.
* 
```{r}
chocolates %>% 
  mutate(Type = factor(Type)) %>%
  ggplot(aes(x = Sugars_g, y = Calories, color = Type)) +
  geom_point() + 
  ggtitle("The relationship between calories and sugars relative to chocolate types") +
  xlab("Sugars")
```


## Scatter plot
* Using function geom_point() in the ggplot2 package 
* Using mtcars as our data 

### Simple point plot 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg)) + 
  geom_point()
```

### Multiple colors based on factor(cyl)
* factor(cyl) should be factor 
* color is in the aes()
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg, color = factor(cyl))) + 
  geom_point()
```

### Blue color 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg)) + 
  geom_point(color = "blue")
```

### Point with different shapes 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg, shape = factor(cyl))) + 
  geom_point()
```

### Point with different sizes 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg, size = factor(cyl))) + 
  geom_point()
```

### Point with transparency
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg, alpha = factor(cyl))) + 
  geom_point()
```

### Combined with color and shape 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg, shape = factor(cyl), color = factor(cyl))) + 
  geom_point()
```

## Facetting 
### Using facet_wrap()
* Using mpg as our data frame 
* Type of the data: character, integer and double
```{r}
glimpse(mpg)
ggplot(data = mtcars, aes(x = wt, y = mpg)) + 
  geom_point() + 
  facet_wrap(~factor(cyl))
```

### Using facet_grid()
* Adding facets categorized by multiple varibles
```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ .)

ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(drv~cyl)
```

## Line graph 
### Simple line graph
* Using function geom_line()
```{r}
ggplot(data = mpg, aes(x = displ, y = hwy)) + 
  geom_line()
```

### Fit a linear regression 
* Using span to control the "wiggliness" of the default loess smoother.
* The span is the fraction of points used to fit each local regression.
* Small numbers make a wigglier curve, larger numbers make a smoother curve.
```{r}
ggplot(data = mpg, aes(x = displ, y = hwy)) + 
  geom_point() +
  geom_smooth()
```

* With standard error and without standard error 
* se() controls for standard error 
```{r}
ggplot(data = mpg, aes(x = displ, y = hwy)) + 
  geom_point() +
  geom_smooth(span = 0.3)

ggplot(data = mpg, aes(x = displ, y = hwy)) + 
  geom_point() +
  geom_smooth(span = 0.3, se = FALSE)
```

### Adding a vertical line 
```{r}
ggplot(data = mtcars, aes(x = wt, y = mpg)) + 
  geom_point() +
  geom_vline(xintercept = 3)

ggplot(data = mtcars, aes(x = wt, y = mpg)) + 
  geom_point() +
  geom_vline(xintercept = 3, linetype = "dotted", 
             color = "blue", size = 1.5)
```

## Boxplot, histogram and bar chart 
### Boxplot 
```{r}
ggplot(data = mpg, aes(x = drv, y = hwy)) + 
  geom_boxplot() +
  theme_bw()
```

### Histogram 
* Using binwidth() to adjust the width of each bin  
```{r}
ggplot(data = mpg, aes(hwy)) + 
  geom_histogram(binwidth = 0.6)
```

### Bar chart
```{r}
ggplot(data = mpg, aes(hwy)) + 
  geom_bar()
```

### Count of drv in bar chart 
```{r}
ggplot(data = mpg, aes(hwy, fill = drv)) + 
  geom_bar() +
  scale_fill_brewer(palette="Dark2")
```

### 100% barcharts 
```{r}
ggplot(data = mpg, aes(hwy, fill = drv)) + 
  geom_bar(position="fill") +
  scale_fill_brewer(palette="Dark2")
```

### Side-by-side barcharts 
```{r}
ggplot(data = mpg, aes(x = hwy, fill = drv)) + 
  geom_bar(position="dodge") +
  scale_fill_brewer(palette="Dark2")

ggplot(data = mpg, aes(x = hwy, fill = drv)) + 
  geom_bar(position="dodge") +
  facet_wrap(~class) +
  scale_fill_brewer(palette="Dark2")
```
